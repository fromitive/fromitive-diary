---
title: "디미터의 법칙 묻지말고 시켜라 예외"
description: "설계엔 법칙이 없고 예왼 있다. 적절한 역할에 적절한 책임을 할당하자"
time: 2023-12-18 20:55:25
tags:
  - java
  - software-engineering
---

## 디미터의 법칙 그게 뭔데?

두 명의 회사 동료가 있다. 두 사람은 협업을 위해 프로젝트를 진행하는데, 서로의* 개인 신상은 모르는 상태이다. 마치 처음 만난 사람인것처럼.

각각의 동료를 A,B라고 하자. **디미터의 법칙을 무시하는 경우는** A 가 B에게 제 3자 C를 불러오라고 시킨 뒤, C와 직접적으로 업무를 하는 상황이라고 생각한다. B가 C를 알고 있음을 즉, B의 내부 정보를 A가 아는 상황을 디미터의 법칙을 위반하는 경우이다.

디미터의 법칙을 지키기 위해선,B가 어떤 사람과 관계를 맺는지 B가 무슨 사정이 있는지 A가 모르는 상태에서 B와 직접적으로 협업하면 해결할 수 있다고 생각한다.

## 디미터의 법칙 예외 조건

오브젝트에서는 영화를 보기위해 할인 조건을 만족하면 할인해주는 프로그램을 다음과 같은 예시로 설명하고 있다.

``` java hl_lines="3"
class PeriodDiscountCondition {
    boolean isSatisfiedBy(Screen screen){
        return screen.getStartDayOfWeek().equals(dayOfWeek);
    }
}
```

하이라이트 부분을 보면 `getStartDayOfWeek()`을 통해서 screen과 직접적으로 소통하지 않고 dayOfWeek이라는 내부 정보를 가지고 이를 판단하는 모습이다. 이는 명백히 디미터의 법칙을 무시했다. 그럼, 디미터의 법칙을 만족시키기 위해 screen에 별도의 메소드를 만들어야 할까? **<<오브젝트>>에선 이런경우엔 불필요한 책임이 할당되어 코드 전체의 응집도가 낮아질 수 있음을 경고했다.** 

screen이 가지고 있어야 할 책임소재가 명확해지지 않고, 특정 케이스 즉, 기간에 대한 할인 정책에 대해 만족하는지 확인하는 책임이라는 왜 책임을 지어야 하는지도 모르는 코드가 생성되어 코드 전체 설계 품질이 낮아질 수 있다.

## 묻지 말고 시켜는 경우는 어떠한가?

묻지 말고 시켜라의 핵심은, **객체 내부에서 판단 가능하다면, 판단하지 말고 시켜라**라고 생각한다. 그리고, 무조건 물어보는 것이 잘못된다고 생각하지 않는다. 묻는 것 자체가 책임일 수 있기 때문이다. 다음은 휴일인지 확인하는 코드이다.

```java
void life() {
    if(Holiday.isHoliday(month,day)){
        play();
    }
    study();
}
```

휴일인지, 공휴일인지 확인하기 위해 `Holiday`에게 역할을 준 후, 월과 일을 넘겨 물어보는 코드이다. 만일 Holiday가 play나 study에 대해 판별한다면, Holiday는 `놀기`와 `공부하기`라는 Holiday 입장에선 불필요한 책임을 떠안게 될 것이다. 즉, 묻지말고 시켜라는 한 편으로는 묻는 것만 있을 경우 물어도 된다 라는 예외가 생기기 딱 좋은 법칙이라고 생각한다.







